

'use client';

import { useEffect, useState } from 'react';
import { cn } from '@/lib/utils';

interface LoadingOverlayProps {
  isVisible: boolean;
  message?: string;
  className?: string;
  fullScreen?: boolean;
}

export function LoadingOverlay({
  isVisible,
  message = 'Loading...',
  className,
}: LoadingOverlayProps) {
  const [shouldRender, setShouldRender] = useState(isVisible);

  useEffect(() => {
    if (isVisible) {
      setShouldRender(true);
    } else {
      const timer = setTimeout(() => setShouldRender(false), 300);
      return () => clearTimeout(timer);
    }
  }, [isVisible]);

  if (!shouldRender) return null;

  return (
    <div
      className={cn(
        'z-[50] flex items-center justify-center bg-white/80 backdrop-blur-sm transition-all duration-300',
        isVisible ? 'opacity-100' : 'opacity-0',
        className ?? 'fixed inset-0'

      )}
      style={{ pointerEvents: isVisible ? 'auto' : 'none' }}
    >
      <div className="flex flex-col items-center space-y-4">
        <div className="flex items-center justify-center pt-6">
          <div className="relative w-28 h-28 overflow-hidden">
            <svg className="absolute w-full h-full z-10">
              <mask id="svg-mask" mask-type="luminance">
                <rect width="100%" height="100%" fill="black" />
                <svg viewBox="0 0 287.7 332.21" className="w-full h-full fill-white">
                  <path fill="#e72d07" d="M93.86,143.25c5.86-6.41,9.07-14.72,9.04-23.42-.07-18.45-15.13-33.89-33.58-34.4-.33,0-.67-.01-1-.01-8.95,0-17.4,3.39-23.89,9.61-6.73,6.45-10.5,15.14-10.63,24.46-.11,8.15,2.68,16.1,7.86,22.39,3.82,4.63,8.33,12.12,8.21,21.49l-.05,3.83c-.11,8.11-2.92,15.5-7.91,20.8-5.96,6.33-9.29,14.61-9.37,23.31-.18,18.69,14.88,34.33,33.56,34.86.34,0,.67.01,1,.01,2.05,0,4.07-.18,6.05-.53,6.67-1.17,12.84-4.29,17.84-9.08,6.73-6.45,10.51-15.14,10.64-24.47.11-7.9-2.53-15.67-7.42-21.86-3.63-4.6-7.93-12-7.81-21.16l.08-5.49c.11-8.04,2.73-15.26,7.38-20.35ZM93.86,143.25c5.86-6.41,9.07-14.72,9.04-23.42-.07-18.45-15.13-33.89-33.58-34.4-.33,0-.67-.01-1-.01-8.95,0-17.4,3.39-23.89,9.61-6.73,6.45-10.5,15.14-10.63,24.46-.11,8.15,2.68,16.1,7.86,22.39,3.82,4.63,8.33,12.12,8.21,21.49l-.05,3.83c-.11,8.11-2.92,15.5-7.91,20.8-5.96,6.33-9.29,14.61-9.37,23.31-.18,18.69,14.88,34.33,33.56,34.86.34,0,.67.01,1,.01,2.05,0,4.07-.18,6.05-.53,6.67-1.17,12.84-4.29,17.84-9.08,6.73-6.45,10.51-15.14,10.64-24.47.11-7.9-2.53-15.67-7.42-21.86-3.63-4.6-7.93-12-7.81-21.16l.08-5.49c.11-8.04,2.73-15.26,7.38-20.35ZM167.98,190c5.86-6.41,9.07-14.72,9.04-23.42-.07-18.45-15.13-33.89-33.58-34.4-.33,0-.67-.01-1-.01-8.95,0-17.4,3.39-23.89,9.61-6.73,6.45-10.5,15.14-10.63,24.46-.11,8.15,2.68,16.1,7.86,22.39,3.81,4.63,8.33,12.12,8.21,21.49l-.05,3.83c-.11,8.11-2.92,15.5-7.91,20.8-5.96,6.33-9.29,14.61-9.37,23.31-.18,18.69,14.88,34.33,33.56,34.86.34,0,.67.01,1,.01,2.05,0,4.07-.18,6.05-.53,6.67-1.17,12.84-4.29,17.84-9.08,6.73-6.45,10.51-15.14,10.64-24.47.11-7.9-2.53-15.67-7.42-21.86-3.63-4.6-7.93-12-7.81-21.16l.08-5.49c.11-8.04,2.73-15.26,7.38-20.35ZM279.7,78.43l8,4.62v166.1l-8,4.62-127.86,73.82-8,4.62-8-4.62L8,253.77l-8-4.62V83.05l8-4.62L135.85,4.62l8-4.62,8,4.62,127.86,73.82ZM143.85,313.74l127.86-73.82V92.28L143.85,18.47,15.99,92.28v147.64M279.7,78.43l8,4.62v166.1l-8,4.62-127.86,73.82-8,4.62-8-4.62L8,253.77l-8-4.62V83.05l8-4.62L135.85,4.62l8-4.62,8,4.62,127.86,73.82ZM143.85,313.74l127.86-73.82V92.28L143.85,18.47,15.99,92.28v147.64l127.86,73.82ZM196.44,152.72c6.02,4.22,12.93,6.24,19.78,6.24,2.02,0,4.04-.18,6.03-.53,8.71-1.53,16.84-6.38,22.31-14.18,5.3-7.56,7.33-16.73,5.73-25.81-1.6-9.09-6.64-17.01-14.2-22.31-6.02-4.22-12.93-6.24-19.78-6.24-10.89,0-21.63,5.13-28.34,14.71-10.93,15.6-7.14,37.19,8.47,48.12ZM196.44,152.72c6.02,4.22,12.93,6.24,19.78,6.24,2.02,0,4.04-.18,6.03-.53,8.71-1.53,16.84-6.38,22.31-14.18,5.3-7.56,7.33-16.73,5.73-25.81-1.6-9.09-6.64-17.01-14.2-22.31-6.02-4.22-12.93-6.24-19.78-6.24-10.89,0-21.63,5.13-28.34,14.71-10.93,15.6-7.14,37.19,8.47,48.12ZM113.54,57.7c-10.93,15.6-7.14,37.19,8.47,48.12,6.02,4.22,12.93,6.24,19.78,6.24,2.02,0,4.04-.18,6.03-.53,8.71-1.53,16.84-6.38,22.31-14.18,5.3-7.56,7.33-16.73,5.73-25.81-1.6-9.09-6.64-17.01-14.2-22.31-6.02-4.22-12.93-6.24-19.78-6.24-10.9,0-21.63,5.13-28.34,14.71ZM113.54,57.7c-10.93,15.6-7.14,37.19,8.47,48.12,6.02,4.22,12.93,6.24,19.78,6.24,2.02,0,4.04-.18,6.03-.53,8.71-1.53,16.84-6.38,22.31-14.18,5.3-7.56,7.33-16.73,5.73-25.81-1.6-9.09-6.64-17.01-14.2-22.31-6.02-4.22-12.93-6.24-19.78-6.24-10.9,0-21.63,5.13-28.34,14.71Z"></path>
                </svg>
              </mask>
            </svg>

            <div
              className="absolute inset-0 pointer-events-none"
              style={{
                mask: 'url(#svg-mask)',
                WebkitMask: 'url(#svg-mask)',
              }}
            >
              <div className="w-full h-[200%] bg-gradient-to-b from-transparent via-[#e72d07] animate-shine relative"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
